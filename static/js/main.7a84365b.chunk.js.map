{"version":3,"sources":["components/Login.jsx","components/Medal.jsx","components/Country.jsx","components/NewCountry.jsx","App.js","reportWebVitals.js","index.js"],"names":["Login","props","onLogin","_useState","useState","_useState2","_slicedToArray","username","setUsername","_useState3","_useState4","password","setPassword","history","useHistory","_jsxs","className","onSubmit","e","preventDefault","console","log","push","handleSubmit","children","_jsx","htmlFor","onChange","target","value","autoFocus","type","name","id","placeholder","disabled","length","onClick","Medal","medal","country","onIncrement","onDecrement","canPatch","React","Fragment","Country","medals","onDelete","canDelete","onSave","onReset","sum","forEach","getMedalsTotal","map","NewCountry","onAdd","prompt","trim","App","apiEndpoint","countries","setCountries","connection","setConnection","useRef","_useState5","canPost","_useState6","user","setUser","latestCountries","current","useEffect","_fetchCountries","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axios$get","fetchedCountries","wrap","_context","prev","next","axios","get","sent","data","stop","apply","arguments","fetchCountries","encodedJwt","localStorage","getItem","getUser","newConnection","HubConnectionBuilder","withUrl","withAutomaticReconnect","build","start","then","on","concat","mutableCountries","_toConsumableArray","filter","c","idx","findIndex","catch","handleAdd","_ref","_callee2","_context2","post","headers","t0","response","status","alert","_x","handleDelete","_ref2","_callee3","countryId","originalCountries","_context3","delete","_x2","handleIncrement","medalName","handleUpdate","handleDecrement","_ref3","_callee4","factor","jsonPatch","_context4","op","path","JSON","stringify","patch","window","location","reload","_x3","_x4","_x5","handleLogin","_ref4","_callee5","resp","_context5","token","setItem","_x6","_x7","decodedJwt","jwtDecode","indexOf","Router","reduce","a","b","getAllMedalsTotal","href","removeItem","Link","to","Route","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7a84365b.chunk.js","sourcesContent":["import React, {useState}  from 'react';\r\nimport { useHistory } from \"react-router-dom\";\r\n\r\nfunction Login(props) {\r\n  const { onLogin } = props;\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const history = useHistory();\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    console.log('Submit');\r\n    onLogin(username, password);\r\n    history.push(\"/\");\r\n  }\r\n  const handleCancel = () => {\r\n    history.push(\"/\");\r\n  }\r\n\r\n  return (\r\n    <form className='loginForm' onSubmit={(e) => handleSubmit(e)}>\r\n      <p>\r\n        <label htmlFor=\"username\">Username: </label>\r\n        <input onChange={ (e) => setUsername(e.target.value) } value={username} autoFocus type=\"text\" name=\"username\" id=\"username\" placeholder=\"Username\" />\r\n      </p>\r\n      <p>\r\n        <label htmlFor=\"password\">Password: </label>\r\n        <input onChange={ (e) => setPassword(e.target.value) } value={password} type=\"password\" name=\"password\" id=\"password\" placeholder=\"Password\" />\r\n      </p>\r\n      <p>\r\n        <button disabled={username.length === 0 || password.length === 0} type=\"submit\">Submit</button> <button onClick={handleCancel} type=\"button\">Cancel</button>\r\n      </p>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Login;","import React from 'react';\r\n\r\nconst Medal = (props) => {\r\n  const { medal, country, onIncrement, onDecrement, canPatch } = props;\r\n  return (\r\n    <div className=\"medals\">\r\n      { medal.name } Medals: { country[medal.name] }\r\n      { canPatch && \r\n        <React.Fragment>\r\n          <button onClick={ () => onIncrement(country.id, medal.name) }>+</button>\r\n          <button disabled={ country[medal.name] === 0 } onClick={ () => onDecrement(country.id, medal.name) }>-</button>\r\n        </React.Fragment>\r\n      }\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Medal;","import React from 'react';\r\nimport Medal from './Medal';\r\n\r\nconst Country = (props) => {\r\n  const { country, medals, onIncrement, onDecrement, onDelete, onSave, onReset, canDelete, canPatch } = props;\r\n\r\n  const getMedalsTotal = (country, medals) => {\r\n    let sum = 0;\r\n    medals.forEach(medal => { sum += country[medal.name]; });\r\n    return sum;\r\n  }\r\n  return (\r\n    <div className=\"country\">\r\n      <div className=\"name\">\r\n        { country.name }\r\n        <span className=\"badge\">\r\n          { getMedalsTotal(country, medals) }\r\n        </span>\r\n      </div>\r\n      { medals.map(medal =>\r\n        <Medal \r\n          key={ medal.id } \r\n          country={ country } \r\n          medal={ medal } \r\n          canPatch={ canPatch }\r\n          onIncrement={ onIncrement } \r\n          onDecrement={ onDecrement } />\r\n      ) }\r\n      { canDelete && <button onClick={() => onDelete(country.id)}>delete</button> }\r\n      <hr />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Country;","import React from 'react';\r\n\r\nconst NewCountry = (props) => {\r\n  const { onAdd } = props;\r\n  const handleClick = () => {\r\n    const name = prompt('Enter country name');\r\n    if (name && name.trim().length > 0) {\r\n      onAdd(name);\r\n    }\r\n  }\r\n  return (\r\n    <div className='newCountryButton'>\r\n      <button onClick={ handleClick }>New Country</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NewCountry;\r\n","// Repository:  medals-b-react\r\n// Author:      Jeff Grissom\r\n// Version:     8.xx-01\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport axios from 'axios';\r\nimport { HubConnectionBuilder } from '@microsoft/signalr';\r\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom';\r\nimport jwtDecode from 'jwt-decode';\r\nimport Login from './components/Login';\r\nimport Country from './components/Country';\r\nimport NewCountry from './components/NewCountry';\r\nimport './App.css';\r\n//https://medals-api-final.azurewebsites.net/\r\nconst App = () => {\r\n\r\n  const apiEndpoint = \"https://medals-api-final.azurewebsites.net/jwt/api/country\";\r\n  const hubEndpoint = \"https://medals-api-final.azurewebsites.net/medalsHub\"\r\n  const usersEndpoint = \"https://medals-api-final.azurewebsites.net/api/users/login\";\r\n\r\n  // const apiEndpoint = \"https://localhost:5001/api/country\";\r\n  // const apiEndpoint = \"https://localhost:5001/jwt/api/country\";\r\n  // const hubEndpoint = \"https://localhost:5001/medalsHub\"\r\n  // const usersEndpoint = \"https://localhost:5001/api/users/login\";\r\n  // const apiEndpoint = \"https://medalsapi.azurewebsites.net/api/country\";\r\n  // const apiEndpoint = \"https://medalsapi.azurewebsites.net/jwt/api/country\";\r\n  // const hubEndpoint = \"https://medalsapi.azurewebsites.net/medalsHub\"\r\n  // const usersEndpoint = \"https://medalsapi.azurewebsites.net/api/users/login\";\r\n  const [ countries, setCountries ] = useState([]);\r\n  const [ connection, setConnection] = useState(null);\r\n  const medals = useRef([\r\n    { id: 1, name: 'gold' },\r\n    { id: 2, name: 'silver' },\r\n    { id: 3, name: 'bronze' },\r\n  ]);\r\n  const [ user, setUser ] = useState(\r\n    {\r\n      name: null,\r\n      canPost: false,\r\n      canPatch: false,\r\n      canDelete: false\r\n    }\r\n  );\r\n  const latestCountries = useRef(null);\r\n  // latestCountries.current is a ref variable to countries\r\n  // this is needed to access state variable in useEffect w/o dependency\r\n  latestCountries.current = countries;\r\n\r\n  // this is the functional equivalent to componentDidMount\r\n  useEffect(() => {\r\n    // initial data loaded here\r\n    async function fetchCountries() {\r\n      const { data : fetchedCountries } = await axios.get(apiEndpoint);\r\n      setCountries(fetchedCountries);\r\n    }\r\n    fetchCountries();\r\n\r\n    const encodedJwt = localStorage.getItem(\"token\");\r\n    // check for existing token\r\n    if (encodedJwt) {\r\n      setUser(getUser(encodedJwt));\r\n    }\r\n\r\n    // signalR\r\n    const newConnection = new HubConnectionBuilder()\r\n      .withUrl(hubEndpoint)\r\n      .withAutomaticReconnect()\r\n      .build();\r\n\r\n    setConnection(newConnection);\r\n  }, []);\r\n  // componentDidUpdate (changes to connection)\r\n  useEffect(() => {\r\n    if (connection) {\r\n      connection.start()\r\n      .then(() => {\r\n        console.log('Connected!')\r\n\r\n        connection.on('ReceiveAddMessage', country => {\r\n          console.log(`Add: ${country.name}`);\r\n          let mutableCountries = [...latestCountries.current];\r\n          mutableCountries = mutableCountries.concat(country);\r\n\r\n          setCountries(mutableCountries);\r\n        });\r\n\r\n        connection.on('ReceiveDeleteMessage', id => {\r\n          console.log(`Delete id: ${id}`);\r\n          let mutableCountries = [...latestCountries.current];\r\n          mutableCountries = mutableCountries.filter(c => c.id !== id);\r\n\r\n          setCountries(mutableCountries);\r\n        });\r\n\r\n        connection.on('ReceivePatchMessage', country => {\r\n          console.log(`Patch: ${country.name}`);\r\n          let mutableCountries = [...latestCountries.current];\r\n          const idx = mutableCountries.findIndex(c => c.id === country.id);\r\n          mutableCountries[idx] = country;\r\n\r\n          setCountries(mutableCountries);\r\n        });\r\n      })\r\n      .catch(e => console.log('Connection failed: ', e));\r\n    }\r\n  // useEffect is dependent on changes connection\r\n  }, [connection]);\r\n\r\n  const handleAdd = async (name) => {\r\n    try {\r\n      await axios.post(apiEndpoint, {\r\n        name: name\r\n      }, {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n    } catch (ex) {\r\n      if (ex.response && (ex.response.status === 401 || ex.response.status === 403)) {\r\n        alert(\"You are not authorized to complete this request\");\r\n      } else if (ex.response) {\r\n        console.log(ex.response);\r\n      } else {\r\n        console.log(\"Request failed\");\r\n      }\r\n    }\r\n  }\r\n  const handleDelete = async (countryId) => {\r\n    const originalCountries = countries;\r\n    setCountries(countries.filter(c => c.id !== countryId));\r\n    try {\r\n      await axios.delete(`${apiEndpoint}/${countryId}`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n    } catch (ex) {\r\n      if (ex.response && ex.response.status === 404) {\r\n        // country already deleted\r\n        console.log(\"The record does not exist - it may have already been deleted\");\r\n      } else { \r\n        setCountries(originalCountries);\r\n        if (ex.response && (ex.response.status === 401 || ex.response.status === 403)) {\r\n          alert(\"You are not authorized to complete this request\");\r\n        } else if (ex.response) {\r\n          console.log(ex.response);\r\n        } else {\r\n          console.log(\"Request failed\");\r\n        }\r\n      }\r\n    }\r\n  }\r\n  const handleIncrement = (countryId, medalName) => handleUpdate(countryId, medalName, 1);\r\n  const handleDecrement = (countryId, medalName) =>  handleUpdate(countryId, medalName, -1)\r\n  const handleUpdate = async (countryId, medalName, factor) => {\r\n    const idx = countries.findIndex(c => c.id === countryId);\r\n    const mutableCountries = [...countries ];\r\n    mutableCountries[idx][medalName] += (1 * factor);\r\n    setCountries(mutableCountries);\r\n    const jsonPatch = [{ op: \"replace\", path: medalName, value: mutableCountries[idx][medalName] }];\r\n    console.log(`json patch for id: ${countryId}: ${JSON.stringify(jsonPatch)}`);\r\n\r\n    try {\r\n      await axios.patch(`${apiEndpoint}/${countryId}`, jsonPatch, {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\r\n        }\r\n      });\r\n    } catch (ex) {\r\n      if (ex.response && ex.response.status === 404) {\r\n        // country does not exist\r\n        console.log(\"The record does not exist - it may have been deleted\");\r\n      } else if (ex.response && (ex.response.status === 401 || ex.response.status === 403)) { \r\n        // in order to restore the defualt medal counts, we would need to save \r\n        // the page value and saved value for each medal (like in the advanced example)\r\n        alert('You are not authorized to complete this request');\r\n        // to simplify, I am reloading the page instead\r\n        window.location.reload(false);\r\n      } else if (ex.response) {\r\n        console.log(ex.response);\r\n      } else {\r\n        console.log(\"Request failed\");\r\n      }\r\n    }\r\n  }\r\n  const handleLogin = async (username, password) => {\r\n    try {\r\n      const resp = await axios.post(usersEndpoint, { username: username, password: password });\r\n      const encodedJwt = resp.data.token;\r\n      localStorage.setItem('token', encodedJwt);\r\n      setUser(getUser(encodedJwt));\r\n    } catch (ex) {\r\n      if (ex.response && (ex.response.status === 401 || ex.response.status === 400 )) {\r\n        alert(\"Login failed\");\r\n      } else if (ex.response) {\r\n        console.log(ex.response);\r\n      } else {\r\n        console.log(\"Request failed\");\r\n      }\r\n    }\r\n  }\r\n  const handleLogout = (e) => {\r\n    e.preventDefault();\r\n    console.log('logout');\r\n    localStorage.removeItem('token');\r\n    setUser({\r\n      name: null,\r\n      canPost: false,\r\n      canPatch: false,\r\n      canDelete: false\r\n    });\r\n    return false;\r\n  }\r\n  const getUser = (encodedJwt) => {\r\n    // return unencoded user / permissions\r\n    const decodedJwt = jwtDecode(encodedJwt);\r\n    return {\r\n      name: decodedJwt['username'],\r\n      canPost: decodedJwt['roles'].indexOf('medals-post') === -1 ? false : true,\r\n      canPatch: decodedJwt['roles'].indexOf('medals-patch') === -1 ? false : true,\r\n      canDelete: decodedJwt['roles'].indexOf('medals-delete') === -1 ? false : true,\r\n    };\r\n  }\r\n  const getAllMedalsTotal = () => {\r\n    let sum = 0;\r\n    medals.current.forEach(medal => { sum += countries.reduce((a, b) => a + b[medal.name], 0); });\r\n    return sum;\r\n  }\r\n  return (\r\n    <Router>\r\n      <div className='appHeading'>\r\n        Olympic Medals\r\n        <span className='badge'>\r\n          { getAllMedalsTotal() }\r\n        </span>\r\n        {user.name ? \r\n          <span className='logout'><a href=\"/\" onClick={handleLogout} className='logoutLink'>Logout</a> [{user.name}]</span>\r\n          :\r\n          <Link to=\"/login\" className='loginLink'>Login</Link>\r\n        }\r\n      </div>\r\n      <Route exact path=\"/login\">\r\n        <Login onLogin={handleLogin} />\r\n      </Route>\r\n      <div className='countries'>\r\n          { countries.map(country => \r\n            <Country \r\n              key={ country.id } \r\n              country={ country } \r\n              medals={ medals.current }\r\n              canDelete={ user.canDelete }\r\n              canPatch={ user.canPatch }\r\n              onDelete={ handleDelete }\r\n              onIncrement={ handleIncrement } \r\n              onDecrement={ handleDecrement } />\r\n          )}\r\n      </div>\r\n      { user.canPost && <NewCountry onAdd={ handleAdd } /> }\r\n    </Router>\r\n  );\r\n}\r\n \r\nexport default App;","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}